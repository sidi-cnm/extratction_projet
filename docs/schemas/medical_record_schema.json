{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "MedicalRecord",
  "type": "object",
  "properties": {
    "patient": {
      "type": "object",
      "properties": {
        "id": { "type": ["string", "null"] },
        "nom": { "type": "string" },
        "date_naissance": { "type": "string", "format": "date" },
        "sexe": { "type": "string" },
        "adresse": { "type": ["string", "null"] }
      },
      "required": ["nom", "date_naissance", "sexe"]
    },

    "antecedents_medicaux": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "condition": { "type": "string" },
          "date_diagnostic": { "type": ["string", "null"], "format": "date" },
          "status": { "type": ["string", "null"] },
          "type": { "type": ["string", "null"] },
          "gravite": { "type": ["string", "null"] }
        },
        "required": ["condition"]
      }
    },

    "traitements_actuels": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "medicament": { "type": "string" },
          "dose": { "type": ["string", "null"] },
          "posologie": { "type": ["string", "null"] },
          "indication": { "type": ["string", "null"] },
          "debut_traitement": { "type": ["string", "null"], "format": "date" },
          "fin_traitement": { "type": ["string", "null"], "format": "date" }
        },
        "required": ["medicament"]
      }
    },

    "consultations": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "date": { "type": "string", "format": "date" },
          "motif": { "type": ["string", "null"] },
          "observations": { "type": ["string", "null"] },
          "diagnostic": { "type": ["string", "null"] },
          "traitement_prescrit": { "type": ["string", "null"] }
        },
        "required": ["date", "diagnostic"]
      }
    },

    "examens": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "date": { "type": "string", "format": "date" },
          "type": { "type": "string" },
          "resultat": { "type": ["string", "null"] }
        },
        "required": ["date", "type"]
      }
    },

    "resume_structure": {
      "type": "object",
      "properties": {
        "maladies": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "nom": { "type": "string" },
              "premiere_mention": { "type": ["string", "null"], "format": "date" },
              "statut": { "type": ["string", "null"] },
              "derniere_consultation": { "type": ["string", "null"], "format": "date" },
              "confiance": { "type": ["number", "null"], "minimum": 0, "maximum": 1 }
            },
            "required": ["nom"]
          }
        },
        "allergies": {
          "type": "array",
          "items": { "type": "string" }
        },
        "traitements": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },

    "meta": {
      "type": "object",
      "properties": {
        "langue": { "type": "string" },
        "source": { "type": "string" },
        "date_extraction": { "type": "string", "format": "date" },
        "modele_utilise": { "type": "string" },
        "confiance_moyenne": { "type": ["number", "null"], "minimum": 0, "maximum": 1 },
        "schema_version": { "type": "string" }
      },
      "required": ["langue", "date_extraction", "modele_utilise"]
    },

    "document_source": {
      "type": "object",
      "properties": {
        "nom_fichier": { "type": "string" },
        "type": { "type": "string" },
        "id_document": { "type": ["string", "null"] }
      },
      "required": ["nom_fichier", "type"]
    }
  },

  "required": ["patient", "resume_structure", "meta"]
}
